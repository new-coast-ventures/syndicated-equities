<%= render partial: "modal_form" %>
<div class='table-page-header'>
  <button type="button" style="float: right; background: white" data-toggle="modal" data-target="#property-form-modal""> Add Property</button>
  <h5 class="dashboard-title">Properties (<%= @active_properties.count %> Active)</h5>
</div>

<% if @properties.any? %>
  <div class="table-responsive">
		<table class="table table-bordered"id="sortable-table" cellspacing="0" width="100%">
			<thead class="thead-default">
				<tr>
					<th>Legal Name</th>
					<th>Nickname</th>
					<th>Closing Date</th>
					<th>Address</th>
					<th>City</th>
					<th>State</th>
					<th>Sale Date</th>
					<th>Deal Equity</th>
				</tr>
			</thead>
			<tbody>
				<% @properties.each do |prop| %>
					<tr>
						<td><%= link_to prop.name, property_path(prop.id) %></td>
						<td><%= prop.nickname %></td>
						<td><%= prop&.closing_date&.strftime("%m-%d-%Y") %></td>
						<td><%= prop&.address&.line1 %></td>
						<td><%= prop&.address&.city %></td>
						<td><%= prop&.address&.state %></td>
						<td><%= prop&.deals&.first&.date&.strftime("%m-%d-%Y") %></td>
						<td><%= number_to_currency(prop.deal_equity, precision: 0) %></td>
					</tr>
				<% end %>
			</tbody>
		</table>
	</div>
<% else %>
  <p>There are no properties that match your search.</p>
<% end %>

<script>
  $(document).ready(function() {
    $('#sortable-table').DataTable({
      "paging": true,
      "info": false,
			"order": [[3, "desc"]],
			"columnDefs": [{ "searchable": false, "targets": [2,3,4,5,6,7] }],
			  "language": {
					"zeroRecords": "There are no properties that match your search.",
					searchPlaceholder: "Legal name or nickname",
					search: "",
				}
		});
		  });
</script>